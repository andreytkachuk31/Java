<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:p="http://www.springframework.org/schema/p"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

	<bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer" p:location="base.properties"/>
	
	<bean id="user" class="com.epam.kation.model.user.DefaultUser" scope="prototype"/>
 	<bean id="event" class="com.epam.kation.model.event.DefaultEvent" scope="prototype"/>
 	<bean id="ticket" class="com.epam.kation.model.ticket.DefaultTicket" scope="prototype"/>
		
	<bean id="userClonner" class="com.epam.kation.dao.storage.clonner.UserClonner">
 		<lookup-method name="newUser" bean="user"/>
 	</bean>
 	 <bean id="eventClonner" class="com.epam.kation.dao.storage.clonner.EventClonner">
 		<lookup-method name="newEvent" bean="event"/>
 	</bean>
 	 <bean id="ticketClonner" class="com.epam.kation.dao.storage.clonner.TicketClonner">
 		<lookup-method name="newTicket" bean="ticket"/>
 	</bean>
 	
 	<bean id="userComparator" class="com.epam.kation.dao.storage.comparator.UserComparator"/>
 	<bean id="eventComparator" class="com.epam.kation.dao.storage.comparator.EventComparator"/>
 	<bean id="ticketComparator" class="com.epam.kation.dao.storage.comparator.TicketComparator"/>
 	
 	<bean id="userIdGenerator" class="com.epam.kation.dao.storage.id.generator.UserIdGenerator"/>
 	<bean id="eventIdGenerator" class="com.epam.kation.dao.storage.id.generator.EventIdGenerator"/>
 	<bean id="ticketIdGenerator" class="com.epam.kation.dao.storage.id.generator.TicketIdGenerator"/>
 	
 	<bean id="userIdHandler" class="com.epam.kation.dao.storage.id.handler.UserIdHandler"/>
 	<bean id="eventIdHandler" class="com.epam.kation.dao.storage.id.handler.EventIdHandler"/>
 	<bean id="ticketIdHandler" class="com.epam.kation.dao.storage.id.handler.TicketIdHandler"/>
 	
 	<bean id="memoryStorage" class="com.epam.kation.dao.storage.MemoryStorage" p:path="${initial.storage.path}">
 		<property name="types">
 			<map>
 				<entry key="com.epam.kation.model.user.User" value="user"/>
 				<entry key="com.epam.kation.model.event.Event" value="event"/>
 				<entry key="com.epam.kation.model.ticket.Ticket" value="ticket"/>
 			</map>
 		</property>
 		<property name="idGenerators">
 		 	<map>
 				<entry key="user" value-ref="userIdGenerator"/>
 				<entry key="event" value-ref="eventIdGenerator"/>
 				<entry key="ticket" value-ref="ticketIdGenerator"/>
 			</map>
 		</property>
 		<property name="idHandlers">
 		 	<map>
 				<entry key="user" value-ref="userIdHandler"/>
 				<entry key="event" value-ref="eventIdHandler"/>
 				<entry key="ticket" value-ref="ticketIdHandler"/>
 			</map>
 		</property>
 		<property name="comparators">
  		 	<map>
 				<entry key="user" value-ref="userComparator"/>
 				<entry key="event" value-ref="eventComparator"/>
 				<entry key="ticket" value-ref="ticketComparator"/>
 			</map>
 		</property>
 		<property name="clonners">
  		 	<map>
 				<entry key="user" value-ref="userClonner"/>
 				<entry key="event" value-ref="eventClonner"/>
 				<entry key="ticket" value-ref="ticketClonner"/>
 			</map>
 		</property>
 		<property name="map">
 			<map></map>
 		</property>
 	</bean>
 	
 	 <bean id="userDao" class="com.epam.kation.dao.user.DefaultUserDao" autowire="byType">
 	 	<lookup-method name="newUser" bean="user"/>
 	 </bean>
 	 <bean id="eventDao" class="com.epam.kation.dao.event.DefaultEventDao" autowire="byType">
 	 	<lookup-method name="newEvent" bean="event"/>
 	 </bean>
 	 <bean id="ticketDao" class="com.epam.kation.dao.ticket.DefaultTicketDao" autowire="byType">
 	 	<lookup-method name="newTicket" bean="ticket"/>
 	 </bean>
 	
 	 <bean id="userService" class="com.epam.kation.service.user.DefaultUserService" p:userDao-ref="userDao"/>
 	 <bean id="eventService" class="com.epam.kation.service.event.DefaultEventService" p:eventDao-ref="eventDao"/>
 	 <bean id="ticketService" class="com.epam.kation.service.ticket.DefaultTicketService" p:ticketDao-ref="ticketDao"/>
 	 
 	 <bean id="defaultBookingFacade" class="com.epam.kation.facade.DefaultBookingFacade">
 	 	<constructor-arg name="userService" ref="userService"/>
 	 	<constructor-arg name="eventService" ref="eventService"/>
 	 	<constructor-arg name="ticketService" ref="ticketService"/>
 	 </bean>
 	 
</beans>